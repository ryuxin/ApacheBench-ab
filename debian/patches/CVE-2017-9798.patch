Description: fix optionsbleed information leak
Origin: upstream, https://svn.apache.org/viewvc?view=revision&revision=1807754
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=876109

Index: apache2-2.4.7/server/core.c
===================================================================
--- apache2-2.4.7.orig/server/core.c	2017-09-18 11:09:35.156944672 -0400
+++ apache2-2.4.7/server/core.c	2017-09-18 11:09:35.156944672 -0400
@@ -2055,6 +2055,12 @@ AP_CORE_DECLARE_NONSTD(const char *) ap_
             /* method has not been registered yet, but resorce restriction
              * is always checked before method handling, so register it.
              */
+            if (cmd->pool == cmd->temp_pool) {
+                /* In .htaccess, we can't globally register new methods. */
+                return apr_psprintf(cmd->pool, "Could not register method '%s' "
+                                   "for %s from .htaccess configuration",
+                                    method, cmd->cmd->name);
+            }
             methnum = ap_method_register(cmd->pool,
                                          apr_pstrdup(cmd->pool, method));
         }
